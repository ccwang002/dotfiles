#
# MPV CONFIGURATIONS
# Adapted from http://paste.muratcansimsek.com/raw/4NcPuAKMex
#
# for mpv v0.16.0 or newer with vapoursynth and mvtools (last change, 5 April 2016)
#

#
# Input settings live in ~/.config/mpv/input.conf
#
# First four line disables Trackpad swiping, otherwise mpv detects Trackpad
# gestures as commands and creates a mess. This fixes it. Clicking still works.
#
# AXIS_UP    ignore
# AXIS_DOWN  ignore
# AXIS_LEFT  ignore
# AXIS_RIGHT ignore
#
# Following disables mpv's fullscreen controls and leaves it for
# OS X's window manager. This way, you can use native OS X fullscreen
# but there would be no shortcuts. You can use window buttons without these
# too, but I find that double clicking to fullscreen usually happens reflexively,
# so I disabled it.
#
# f ignore
# MOUSE_BTN0_DBL ignore
#
# Following line makes vapoursynth optional, more about it later.
#
# P vf toggle vapoursynth=~/.config/mpv/vapoursynth/interpolation.py
#
# Following line enables and disables bs2b, a filter to turn sound into
# binaural, which improves listening with headphones. ffmpeg must be installed
# with --with-libbs2b to use this.
#
# H af toggle lavfi=[bs2b=profile=jmeier]
#

#
# On screen control settings live in ~/.config/mpv/lua-settings/osc.conf
#
# valign line carries the OSC to the top of the screen so that it would
# not cover the subtitles. Others are self-explanatory. You also might
# like to check the manual for additional layout and seekbar styles.
# The ones I used are the most minimalistic ones.
#
# layout=slimbox
# valign=-1
# boxalpha=160
# hidetimeout=1000
# seekbarstyle=bar
#

#
# For the details of 60 fps playback check here:
#
# https://redd.it/3uttwj
#

#
# MPV Settings
#

#
# Video
#
# While the highest quality preset is the best quality we can
# get, it will kill your CPU with older retina screens and Macbook Airs.
# Therefore we have other presets too. Use the high with
# Macbook Air and the medium with older Retina screens. Highest quality
# would be fine with them if hardware acceleration works, but it
# doesn't work with all the formats.
#
# Important thing to note here is that we have seperate presets for
# 60 fps playback with vapoursynth. The usual presets are too demanding
# on CPU and vapoursynth can't work well with them. If you want to use
# vapoursynth, just disable all the others and enable the one below. The
# difference between high and medium is debanding.
#
# If you want to use vapoursynth with other presets, you need to disable
# hwdec and remove interpolation. Removing debanding might help too.
#
# Non-vapoursynth, highest quality preset is the default one.
# If you have problems, downgrade one-by-one.
#

video-sync=display-resample

#
# Vapoursynth high quality preset
#
# vo=opengl:scale=spline36:cscale=spline36:dscale=mitchell:dither-depth=auto:correct-downscaling:sigmoid-upscaling:icc-profile-auto:es=no:deband
# hwdec=no

#
# Vapoursynth medium quality preset
#
# vo=opengl:scale=spline36:cscale=spline36:dscale=mitchell:dither-depth=auto:correct-downscaling:sigmoid-upscaling:icc-profile-auto:es=no
# hwdec=no

#
# Highest quality preset
#
vo=opengl:scale=ewa_lanczossharp:cscale=ewa_lanczossharp:scale-antiring=0.8:dscale=mitchell:dither-depth=auto:correct-downscaling:sigmoid-upscaling:icc-profile-auto:deband:blend-subtitles:tscale-clamp:interpolation:es=no
hwdec=videotoolbox

#
# High quality preset
#
# vo=opengl:scale=spline36:cscale=spline36:scale-antiring=0.6:dscale=mitchell:dither-depth=auto:correct-downscaling:sigmoid-upscaling:icc-profile-auto:deband:blend-subtitles:tscale-clamp:interpolation:es=no
# hwdec=videotoolbox

#
# Medium quality preset
#
# vo=opengl:scale=spline36:cscale=spline36:dscale=mitchell:dither-depth=auto:correct-downscaling:sigmoid-upscaling:blend-subtitles:tscale-clamp:interpolation
# hwdec=videotoolbox

#
# I have also included a low quality preset here, but I really
# do not recommend its use. If you are down to this, you might be
# better of with VLC or mplayerx. Medium quality preset is still better
# than them, but not this. Only real world use I can foresee is using
# it with 1080p videos and vapoursynth.
#
# vo=opengl:scale=bilinear
# hwdec=no

#
# Display
#
# To autofit-larger, you should write your screen resolution, if you don't know
# it, check here: http://www.whatismyscreenresolution.com
#
# Set fs line to *yes* if you want to start with mpv's non-native fullscreen.
# Others are all easy to understand.
#

fs=no
force-window=yes
stop-screensaver
cursor-autohide=1000
osd-font='Helvetica Neue'

#
# Sound
#
# softvol controls mpv's volume settings, here it is disabled and left for
# OS X's mixer. Set audio channels as needed. This is fine for headphones.
#

softvol=no
audio-channels=2
ao=coreaudio:change-physical-format=yes

#
# Enable the line below to make Bauer stereo to binaural transformation default,
# which improves headphone listening of stereo audio records. ffmpeg must be installed
# with --with-libbs2b to use this.
#
# af=lavfi=[bs2b=profile=jmeier]

#
# Subtiles, with Crunchyroll defaults.
#
# I have choosen CR defaults since they are familiar
# and everyone should have the typeface.
#
# sub-codepage is the subtitle encoding. Check the wiki page for your language
# and change the second one: https://en.wikipedia.org/wiki/Windows_code_page#List
#

# alang=jp,jpn
# slang=en,enUS

sub-auto=fuzzy
# sub-text-font='Trebuchet MS'
# sub-text-border-size=1
# sub-text-font-size=54
# sub-text-margin-y=38

sub-codepage=utf8:big5

ass-vsfilter-aspect-compat=yes


#
# Scripts
#
# mpv can load Lua scripts to do various things, here is a compendium
# of some scripts: https://github.com/mpv-player/mpv/wiki/User-Scripts
#
# Scripts are installed under ~/.config/mpv/scripts
#

script=~/.config/mpv/scripts/autoload.lua,~/.config/mpv/scripts/stats.lua

#
# stats.lua -> https://raw.githubusercontent.com/Slyneth/mpv-stats/master/stats.lua
#
# Displays some statistics about the currently played file on-screen with i.
#
# autoload.lua -> https://raw.githubusercontent.com/mpv-player/mpv/master/TOOLS/lua/autoload.lua
#
# Automatically loads playlist entries before and after the currently
# playing file, by scanning the directory.
#
# This is the script ~/.config/mpv/scripts/autosub.lua :
#
# This script is to download subtitles automatically using
# subliminal. To search subtitles, use the key b. You change subtitles
# with j and open/close them with v. If you want to change the subtitle
# language, change en in the t.args line.
#
# -- requires subliminal, version 1.0 or newer
# -- default keybinding: b
# local utils = require 'mp.utils'
# function load_sub_fn()
#     subl = "/usr/local/bin/subliminal" -- use 'which subliminal' to find the path
#     mp.msg.info("Searching subtitle")
#     mp.osd_message("Searching subtitle")
#     t = {}
#     t.args = {subl, "download", "-s", "-l", "en", mp.get_property("path")}
#     res = utils.subprocess(t)
#     if res.status == 0 then
#         mp.commandv("rescan_external_files", "reselect")
#         mp.msg.info("Subtitle download succeeded")
#         mp.osd_message("Subtitle download succeeded")
#     else
#         mp.msg.warn("Subtitle download failed")
#         mp.osd_message("Subtitle download failed")
#     end
# end
#
# mp.add_key_binding("b", "auto_load_subs", load_sub_fn)
#

#
# Misc.
#
# save-position-on-quit will save the current playback position on quit.
# When this file is played again later, the player will seek to the old
# playback position on start. Works with streaming too.
#
# input-media-keys controls whether or not mpv will have control over media
# keys. Set it to *yes* if you want to use them with mpv.
#
# cache-default determines how much of the video file will be cached
# while streaming. Here it is set to 578.3 MBs. While this seems much, it is
# actually just enough to cache 1080p anime episodes entirely so that you
# could continue watching if you experience network problems.
#
# cache-pause pauses the playback when cache is empty, this is cleaner.
#
# cache-initial determines how long to wait before playback, filling
# the cache. These are all on KBs.
#

screenshot-template=~/Desktop/mpv-shot%04n
screenshot-format=png

# input-media-keys=yes
# cache-default=600000
# cache-initial=4096
# cache-pause

#
# END
#
